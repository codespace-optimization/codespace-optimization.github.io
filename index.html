<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Scattered Forest Search -- smarter code space exploration with scaling LLM inference.">
  <meta name="keywords" content="Code Generation, LLM Inference, Optimization, Scattered Forest Search">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scattered Forest Search: Smarter Code Space Exploration with LLM Inference</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/explorer-index.js"></script>
</head>
<body>

<!-- NAVIGATION BAR -->
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">More Research</a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://avalonbench.github.io">
            <span class="small-caps">AvalonBench</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- HERO HEADER -->
<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">

          <!-- PAPER TITLE -->
          <h1 class="title is-1 publication-title">
            <span class="textsc">Scattered Forest Search</span>: Smarter Code Space Exploration with LLM Inference
          </h1>

          <!-- AUTHORS -->
          <div class="is-size-5 publication-authors">
            <span class="author-block"><a href="https://jonathanmli.github.io/" target="_blank">Jonathan Light</a><sup>1</sup>,</span>
            <span class="author-block"><a href="https://yuewu.us/" target="_blank">Yue Wu</a><sup>2</sup>,</span>
            <span class="author-block"><a href="https://sunyiyou.github.io/" target="_blank">Yiyou Sun</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://yuwenchao.github.io/" target="_blank">Wenchao Yu</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://yanchiliu.github.io/" target="_blank">Yanchi Liu</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://zxj32.github.io/" target="_blank">Xujiang Zhao</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://acbull.github.io/" target="_blank">Ziniu Hu</a><sup>4</sup>,</span>
            <span class="author-block"><a href="https://haifengchen.gitlab.io/intro/" target="_blank">Haifeng Chen</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://chengw07.github.io/" target="_blank">Wei Cheng</a><sup>3</sup></span>
          </div>


          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Rensselaer Polytechnic Institute,</span>
            <span class="author-block"><sup>2</sup>Princeton University,</span>
            <span class="author-block"><sup>3</sup>NEC Laboratories America,</span>
            <span class="author-block"><sup>4</sup>XAi</span>
          </div>

          <!-- LINKS -->
          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2411.05010"
                   class="external-link button is-normal is-rounded is-dark" target="_blank">
                  <span class="icon"><i class="fas fa-file-pdf"></i></span>
                  <span>PDF</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2411.05010"
                   class="external-link button is-normal is-rounded is-dark" target="_blank">
                  <span class="icon"><i class="ai ai-arxiv"></i></span>
                  <span>Arxiv</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/codespace-optimization/sfs"
                   class="external-link button is-normal is-rounded is-dark" target="_blank">
                  <span class="icon"><i class="fab fa-github"></i></span>
                  <span>Code</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://youtu.be/ZKevalFzqFQ"
                   class="external-link button is-normal is-rounded is-dark" target="_blank">
                  <span class="icon"><i class="fab fa-youtube"></i></span>
                  <span>Video</span>
                </a>
              </span>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>

<!-- VIDEO DEMO HERO -->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <!-- Example SFS Demo (replace with correct video if needed) -->
        <source src="./static/videos/sfs_app_demo.mov" type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="textsc">SFS</span> (Scattered Forest Search) Demo for Code Generation
      </h2>
    </div>
  </div>
</section>

<!-- ABSTRACT SECTION -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We propose a novel approach to scaling LLM inference for code generation by viewing the task
            as a black-box optimization problem over the code space. Drawing inspiration from traditional
            optimization, we introduce <strong>Scattered Forest Search (SFS)</strong> to encourage solution
            diversity while leveraging feedback from code execution tests. Our method features three key
            components: <em>Scattering</em>, which prompts the LLM to produce a diverse set of improvement
            directions; <em>Foresting</em>, which expands tree search from multiple random seed solutions;
            and <em>Scouting</em>, which shares successful or unsuccessful improvement “directions” across
            search branches. Experiments on standard code generation tasks—HumanEval, MBPP, APPS,
            CodeContests, and Leetcode—demonstrate significant improvements in pass rates compared to
            repeated sampling, line search, and naive tree search, while also finding correct solutions
            faster and with fewer model calls. Our framework highlights the importance of systematic
            exploration and exploitation strategies when scaling LLM inference for program synthesis.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- METHOD SECTION -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>

        <!-- codespace_viz figure -->
        <figure class="wrap-around-figure">
          <img src="./static/images/codespace_viz.png"
               alt="Visual depiction of the code space" style="max-width: 100%;">
          <figcaption>
            A conceptual 2D illustration of code space. Each point corresponds to a potential code solution.
          </figcaption>
        </figure>

        <div class="content has-text-justified">
          <p>
            Our approach treats code generation as a black-box optimization problem in which
            each generated function or program is an element in the code space. The objective
            is to find a solution passing all hidden tests. We enhance tree search to balance
            exploration (<em>Scattering</em>) and exploitation (leveraging partial successes).
            Specifically:
          </p>
          <ul>
            <li><strong>Scattering:</strong> Before branching from a parent solution, the LLM proposes
              multiple textual “directions” for improvement, ensuring children solutions differ
              significantly and helping to escape local optima.</li>
            <li><strong>Foresting:</strong> We use multiple “seed” solutions and dynamically choose
              which seeds to expand next. Each seed has its own search tree, reducing the risk
              of refining a single flawed seed.</li>
            <li><strong>Scouting:</strong> Global insights about promising or unpromising directions
              are shared across branches so that good directions get reinforced and unproductive
              directions are minimized.</li>
          </ul>
          <p>
            Altogether, SFS finds correct solutions faster and exploits verification signals
            (like partial test passes) more effectively than simpler inference approaches.
          </p>
        </div>

        <!-- prior_methods.png (large, full width, after main method text) -->
        <figure style="margin: 2rem 0;">
          <img src="./static/images/prior_methods.png"
               alt="Prior Methods Visualization" style="max-width:100%;">
          <figcaption>
            Visualization of prior inference-time methods (repeated sampling, line search, tree search).
          </figcaption>
        </figure>

        <!-- optimization_techniques.png (large, full width, after main method text) -->
        <figure style="margin: 2rem 0;">
          <img src="./static/images/optimization_techniques.png"
               alt="Optimization Techniques in Code Space" style="max-width:100%;">
          <figcaption>
            A high-level illustration of the optimization-inspired approaches (Scattering, Foresting, Scouting) used in SFS.
          </figcaption>
        </figure>

      </div>
    </div>
  </div>
</section>

<!-- RESULTS SECTION -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Key Results</h2>
        <div class="content has-text-justified">

          <!-- Single PNG-based results carousel -->
          <div class="carousel results-carousel">
            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_method.png" alt="Scaling with different methods" style="max-width:80%;">
                  <figcaption>Scaling performance across different search methods.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/token_scaling.png" alt="Token Scaling" style="max-width:80%;">
                  <figcaption>Analysis of solution discovery vs. tokens consumed.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/high_budget_scaling.png" alt="High Budget Scaling" style="max-width:80%;">
                  <figcaption>Continuing improvements at higher generation budgets.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_apps.png" alt="Scaling on APPS dataset" style="max-width:80%;">
                  <figcaption>Scaling results on the APPS benchmark.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_codecontests.png" alt="Scaling on CodeContests" style="max-width:80%;">
                  <figcaption>Scaling results on the CodeContests benchmark.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_model.png" alt="Scaling across different LLMs" style="max-width:80%;">
                  <figcaption>Performance across multiple LLM models.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/confusion.png" alt="Confusion Matrix" style="max-width:80%;">
                  <figcaption>Confusion matrix of self-generated validation tests used by SFS.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_groundtruth.png" alt="Scaling with groundtruth tests" style="max-width:80%;">
                  <figcaption>Scaling performance when partial ground truth tests are available.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_humaneval.png" alt="Scaling on HumanEval" style="max-width:80%;">
                  <figcaption>Scaling results on the HumanEval benchmark.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_leetcode.png" alt="Scaling on Leetcode" style="max-width:80%;">
                  <figcaption>Scaling results on Leetcode tasks.</figcaption>
                </figure>
              </div>
            </div>

            <div class="box m-5">
              <div class="content has-text-centered">
                <figure>
                  <img src="static/images/scaling_mbpp.png" alt="Scaling on MBPP" style="max-width:80%;">
                  <figcaption>Scaling results on the MBPP benchmark.</figcaption>
                </figure>
              </div>
            </div>
          </div> <!-- end carousel -->

          <p>
            <strong>Higher accuracy and faster discovery.</strong> On code benchmarks like HumanEval,
            MBPP, APPS, CodeContests, and Leetcode, SFS surpasses repeated sampling (BoN), line
            search, and naive tree search. It also scales better with each additional solution attempt,
            giving a higher probability of finding the correct solution in fewer total LLM calls.
          </p>
          <p>
            <strong>Diverse solutions.</strong> By prompting for multiple directions and seeds, SFS
            avoids generating near-duplicate outputs. The search explores more of the code space, yet
            still exploits valuable partial feedback about correctness.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CONCLUSION SECTION -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Conclusion</h2>
        <div class="content has-text-justified">
          <p>
            In conclusion, <strong>Scattered Forest Search (SFS)</strong> reframes code generation as
            a black-box optimization problem over the code space, systematically balancing exploration
            of new code solutions with exploitation of partial successes. By leveraging simple but
            powerful techniques—Scattering, Foresting, and Scouting—SFS substantially reduces the
            number of calls required to find a correct solution and achieves higher success rates
            across diverse benchmarks.
          </p>
          <p>
            Our results emphasize that code generation with LLMs benefits greatly from improved
            inference-time algorithms. By systematically guiding sampling through textual “directions,”
            ensuring multiple diverse initial seeds, and sharing successful strategies across branches,
            we show that SFS elevates the performance and versatility of LLMs in program synthesis
            tasks.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://arxiv.org/pdf/2411.05010" target="_blank">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/codespace-optimization/sfs" class="external-link" target="_blank">
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is adapted from 
            <a href="https://llm-strategist.github.io/" target="_blank">Strategist</a> 
            and 
            <a href="https://nerfies.github.io/" target="_blank">Nerfies</a>, 
            licensed under a 
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">
              Creative Commons Attribution-ShareAlike 4.0 International License
            </a>.
          </p>          
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
